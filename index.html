<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">

        <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script src="https://d3js.org/topojson.v1.min.js"></script>
        <style>

            html body {
                padding: 0;
                height: 100%;
                width: 100%;
            }

            .region:hover
            {
                opacity: 0.5;
            }

            .flex{
                display: flex;
            }

            #info-panel{
                position: relative;
                width: 250px;
                height: 100%;
                background-color: red;
            }

        </style>
    </head>
<body>

<div class="flex">
    <div id="map-contener">

    </div>
    <div id="info-panel">
        <span id="info-panel-district-name"> </span>
    </div>
</div>

<script>

    /**
     * Globale Felder
     */
    var infoPanelDistrictName = document.getElementById('info-panel-district-name');

    /**
     * Globale Variabeln
     */
    var lastSelectetDistrictName    = '',
        lastSelectetDistrictId      = null;

    /**
     * Wird aufgerufen wenn der User auf eine Region klickt
     * @param featureData das aktuelle "feature"
     */
    function selectDistrict(featureData){

        // Setzen den aktullen wert in die Globalen Variabeln
        lastSelectetDistrictName    = featureData.properties.Stadtteilname;
        lastSelectetDistrictId      = featureData.properties.Stadtteilnummer;

        // In das HTML schreiben
        infoPanelDistrictName.innerHTML = lastSelectetDistrictName;
        console.log('District wurde geklickt',featureData);
    } // end function

d3.json("bundestagswahl_2013_wahlbezirke.geojson", function(error, wb) {
  if (error) return console.error(error);

  var features = wb.features;

  wahlbezirke.selectAll('path')
    .data(features)
    .enter().append('path')
      .attr('d', path)
      .attr('class', 'wahlbezirk')
      .style('fill', '#fff')
      .style('stroke', '#000')
      .style('stroke-width', 1);
});

d3.json("ka_stadtteile.geojson", function(error, wb) {
  if (error) return console.error(error);

  var features = wb.features;

  stadtteile.selectAll('path')
    .data(features)
    .enter().append('path')
      .attr('d', path)
      .attr('class', 'region')
      .on('click', selectDistrict)
      .style('fill', 'rgba(255, 255, 255, 0.7)')
      .style('stroke', '#000')
      .style('stroke-width', 2);
});


var width = 900,
    height = 800;

var svg = d3.select("#map-contener").append("svg")
    .attr("width", width)
    .attr("height", height);

var g = svg.append('g');

var wahlbezirke = g.append('g')
  .classed('wahlbezirke', true);

var stadtteile = g.append('g')
  .classed('stadtteile', true);

var projection = d3.geo.mercator()
  .center([8.41, 49.015])
  .translate([width / 2, height / 2])
  .scale(170000);

var path = d3.geo.path()
  .projection(projection);

</script>
</body>
</html>
