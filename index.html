<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">

        <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script src="https://d3js.org/topojson.v1.min.js"></script>
        <style>

            html, body {
                padding: 0;
                margin: 0;
                height: 100%;
                width: 100%;
                overflow: hidden;
            }

            .wahlbezirk:hover, .district:hover {
                opacity: 0.5;
            }

            .flex{
                display: flex;
            }

            #map-container{
                width: 100%;
            }

            #info-panel{
                position: relative;
                width: 250px;
                height: 100%;
                background-color: red;

                right:-250px;

                -webkit-transition: 1s;
                -moz-transition: 1s;
                -ms-transition: 1s;
                -o-transition: 1s;
                transition: 1s;
            }

            .isOpen{
                right: 0px !important;;
            }

        </style>
    </head>
<body>

<div class="flex">
    <div id="map-container">
        <!-- hier wird die SVG MAP generiert -->
    </div>
    <div id="info-panel">
        <div class="flex" style="justify-content: space-between">
            <span id="info-panel-district-name"> </span>
            <span onclick="closeInfoPanel()">X</span>
        </div>
    </div>
</div>

<script type="application/javascript">

    /**
     * Globale Felder
     */
    var infoPanelDistrictName = document.getElementById('info-panel-district-name'),
        infoPanel = document.getElementById('info-panel');

    /**
     * Globale Variabeln
     */
    var lastSelectetDistrictName    = '',
        lastSelectetDistrictId      = null;

    /**
     * Wird aufgerufen wenn der User auf eine Region klickt
     * @param featureData das aktuelle "feature"
     */
    function selectDistrict(featureData){

        // Setzen den aktullen wert in die Globalen Variabeln
        lastSelectetDistrictName    = featureData.properties.Stadtteilname;
        lastSelectetDistrictId      = featureData.properties.Stadtteilnummer;

        // In das HTML schreiben
        infoPanelDistrictName.innerHTML = lastSelectetDistrictName;
        console.log('District wurde geklickt',featureData);

        infoPanel.classList.add('isOpen');
    } // end function

    /**
     * Schlie√üt das Infopanel
     */
    function closeInfoPanel() {
        infoPanel.classList.remove('isOpen');
    } // end function

d3.json("bundestagswahl_2013_wahlbezirke.geojson", function(error, wb) {
  if (error) return console.error(error);

  var features = wb.features;

  wahlbezirke.selectAll('path')
    .data(features)
    .enter().append('path')
      .attr('d', path)
      .attr('class', 'wahlbezirk')
      .style('fill', '#f00')
      .style('stroke', '#0f0')
      .style('stroke-width', 1);
});

d3.json("ka_stadtteile.geojson", function(error, wb) {
  if (error) return console.error(error);

  var features = wb.features;

  stadtteile.selectAll('path')
    .data(features)
    .enter().append('path')
      .attr('d', path)
      .attr('class', 'district')
      .on('click', selectDistrict)
      .style('fill', 'rgba(0, 128, 0, 0.7)')
      .style('stroke', '#000')
      .style('stroke-width', 2);
});


var width = 900,
    height = 800;

var svg = d3.select("#map-container").append("svg")
    .attr("width", width)
    .attr("height", height);

var g = svg.append('g');

var wahlbezirke = g.append('g')
  .classed('wahlbezirke', true);

var stadtteile = g.append('g')
  .classed('stadtteile', true);

var projection = d3.geo.mercator()
  .center([8.41, 49.015])
  .translate([width / 2, height / 2])
  .scale(170000);

var path = d3.geo.path()
  .projection(projection);

</script>
</body>
</html>
